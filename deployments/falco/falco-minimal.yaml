#
# Minimal Falco Configuration for testing gRPC connection
# This configuration disables the CloudTrail plugin for initial testing
#

# gRPC Output (Required for TFDrift-Falco)
grpc:
  enabled: true
  bind_address: "0.0.0.0:5060"
  threadiness: 0
  # Disable mutual TLS authentication for testing
  server_tls:
    enabled: false

# gRPC Output format
grpc_output:
  enabled: true

# Disable driver (no syscall monitoring)
engine:
  kind: nodriver

# Rules files - use default Falco rules
rules_files:
  - /etc/falco/falco_rules.yaml

# Output format
json_output: true
json_include_output_property: true
json_include_tags_property: true

# Logging
log_stderr: true
log_syslog: false
log_level: info

# Priority filter (send all events to gRPC)
priority: debug

# Buffered output
buffered_outputs: false

# Output channels
outputs:
  rate: 0  # Unlimited rate
  max_burst: 1000

# File output (disabled, using gRPC)
file_output:
  enabled: false

# Stdout output (disabled, using gRPC)
stdout_output:
  enabled: false

# Webserver (disabled)
webserver:
  enabled: false

# Metrics
metrics:
  enabled: false

# Output timeout
output_timeout: 2000

# HTTP output (disabled)
http_output:
  enabled: false
